<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">        
    <link rel="stylesheet" href="app.css">
</head>
<body>

<div v-scope v-cloak>
    <fieldset v-if="mygroups">
        <legend><h3>Mes groupes</h3></legend>
        <ul>
            <li v-for="(attrs, id) in mygroups">
                <span v-scope="SgroupLink(attrs, id)">
                    <span class="my-icon" v-html="svg.users"></span>
                </span>
            </li>
        </ul>
    </fieldset>
    <fieldset>
        <legend><h3>Recherche</h3></legend>
        <form @submit.prevent="search">
            <input v-model="search_token">
        </form>
        <div v-if="search_results">            
            <h4>RÃ©sultats</h4>
            <ul>
                <li v-for="(attrs, id) in search_results">
                    <span v-scope="SgroupLink(attrs, id)">
                        <span class="my-icon" v-html="id.endsWith('.') ? svg.folder : svg.users"></span>
                    </span>
                </li>
            </ul>
        </div>
    </fieldset>
</div>

<script type="module">

import { createApp } from '././node_modules/petite-vue'
import { api, svg, prepare_SgroupLink } from './lib.js'

api("mygroups", {}).then(mygroups => {
    createApp({
        mygroups, 
        SgroupLink: prepare_SgroupLink(), 
        svg,
        search_token: '',
        search_results: undefined,
        async search() {
            this.search_results = await api("search_sgroups", { sizelimit: 10, search_token: this.search_token, right: "updater" })
        }
    }).mount()
})

</script>

</body></html>
